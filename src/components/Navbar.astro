---
const links = [
  { id: 'about', es: 'Sobre mí', en: 'About' },
  { id: 'stack', es: 'Stack', en: 'Tech Stack' },
  { id: 'timeline', es: 'Trayectoria', en: 'Timeline' }
];
---

<nav data-navbar class="relative z-50 pointer-events-auto">
  <div
    class="mx-auto max-w-6xl px-6
          backdrop-blur
          bg-white/70
          dark:bg-zinc-950
          md:dark:bg-zinc-950/5
          border-b border-zinc-200 dark:border-white/5
          text-zinc-900 dark:text-zinc-100">
    <div class="flex h-14 items-center">

      <!-- LOGO -->
      <a href="#top" class="flex items-center gap-2">
        <img src="/icons/logo-jm-light.svg" class="h-8 block dark:hidden" alt="JM logo" />
        <img src="/icons/logo-jm-dark.svg"  class="h-8 hidden dark:block" alt="JM logo" />

        <span
          class="hidden sm:block text-lg font-medium leading-none"
          style="font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;"
        >
          Javier Martín
        </span>
      </a>

      <!-- LINKS DESKTOP -->
      <div class="ml-auto hidden md:flex items-center gap-6 text-sm font-medium">
        {links.map(link => (
          <a
            href={`#${link.id}`}
            class="hover:text-cyan-600 dark:hover:text-cyan-400 transition-colors"
          >
            {link.es}
          </a>
        ))}
      </div>

      <!-- HAMBURGER -->
      <div class="ml-auto flex items-center gap-3 md:ml-4">
        <slot />

        <button
          data-menu-btn
          type="button"
          class="md:hidden p-2
                 text-zinc-700 dark:text-zinc-200
                 hover:text-cyan-600 dark:hover:text-cyan-400
                 transition-colors"
          aria-label="Open menu"
          aria-expanded="false"
        >
          ☰
        </button>
      </div>
    </div>
  </div>

  <!-- MOBILE MENU -->
  <div
    data-mobile-menu
    class="hidden md:hidden absolute top-full inset-x-0 z-50
           pointer-events-auto
           border-t border-zinc-200 dark:border-white/5
           bg-white dark:bg-zinc-950
           text-zinc-900 dark:text-zinc-100"
  >
    <div
      class="mx-auto max-w-6xl px-6 py-4
             flex flex-col gap-4 text-sm font-medium items-end"
    >
      {links.map(link => (
        <a
          href={`#${link.id}`}
          class="hover:text-cyan-600 dark:hover:text-cyan-400 transition-colors"
          data-mobile-link
        >
          {link.es}
        </a>
      ))}
    </div>
  </div>
</nav>

<script is:inline>
  document.addEventListener('DOMContentLoaded', () => {
    document.querySelectorAll('[data-navbar]').forEach((nav) => {
      const btn  = nav.querySelector('[data-menu-btn]');
      const menu = nav.querySelector('[data-mobile-menu]');
      if (!btn || !menu) return;

      btn.addEventListener('click', () => {
        const isOpen = !menu.classList.contains('hidden');
        menu.classList.toggle('hidden', isOpen);
        btn.setAttribute('aria-expanded', String(!isOpen));
      });

      nav.querySelectorAll('[data-mobile-link]').forEach((link) => {
        link.addEventListener('click', () => {
          menu.classList.add('hidden');
          btn.setAttribute('aria-expanded', 'false');
        });
      });

      window.addEventListener('scroll', () => {
        menu.classList.add('hidden');
        btn.setAttribute('aria-expanded', 'false');
      }, { passive: true });
    });
  });
</script>
